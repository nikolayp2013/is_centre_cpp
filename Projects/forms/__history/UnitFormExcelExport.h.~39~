//---------------------------------------------------------------------------

#ifndef UnitFormExcelExportH
#define UnitFormExcelExportH
//---------------------------------------------------------------------------
#include <Classes.hpp>
#include <Controls.hpp>
#include <StdCtrls.hpp>
#include <Forms.hpp>
#include <CheckLst.hpp>
#include "MainClass.h"
#include "DBLookupListBoxCentre.h"
#include "my_DBCtrls.hpp"
#include "UnitFormExcelExportAdd.h"
#include <Buttons.hpp>
#include "UnitFormExcelExportWidth.h"
#include <Dialogs.hpp>
#include <ComCtrls.hpp>
#include <OleServer.hpp>
#include <ADODB.hpp>
#include <DB.hpp>
#include <DBGrids.hpp>
#include <Grids.hpp>
#include <Sockets.hpp>


//---------------------------------------------------------------------------
class TFormExcelExport : public TForm
{
__published:	// IDE-managed Components
	TLabel *Label1;
	TComboBox *ExcelForm_ComboBox;
	TLabel *Label2;
	TLabel *Label3;
	TCheckListBox *ExcelFields_CheckListBox;
	TButton *Button1;
	TButton *Button2;
	TButton *Button3;
	TButton *Button4;
	TButton *Button5;
	TButton *Button6;
	TListBox *Formexcelint_ListBox;
	TSpeedButton *SpeedButton1;
	TLabel *Label4;
	TSaveDialog *SaveDialog1;
	void __fastcall Button1Click(TObject *Sender);
	void __fastcall Formexelint_refresh(TObject *Sender);
	void __fastcall ProcSave(TObject *Sender);
	void __fastcall Button5Click(TObject *Sender);
	void __fastcall Button3Click(TObject *Sender);
	void __fastcall Button4Click(TObject *Sender);
	void __fastcall ExcelForm_ComboBoxClick(TObject *Sender);
	void __fastcall Button2Click(TObject *Sender);
	void __fastcall SpeedButton1Click(TObject *Sender);
	void __fastcall Formexcelint_ListBoxDblClick(TObject *Sender);
	void __fastcall Button6Click(TObject *Sender);
private:	// User declarations
	/* void __fastcall ExcelInit(String File);
   //     void __fastcall formulaExcel(int sRow, int sColumn, int row);
        void __fastcall toExcelCell(int c1,int c2, String data);
        void __fastcall toExcelCell(int c1,int c2, Variant data);

        Variant App,Sh, Book;
        void MakeReport();
        AnsiString xlRCtoA1(int ARow, int ACol, bool RowAbsolute, bool ColAbsolute)
{
  int A1 = CHAR('A') - 1;  // номер "A" минус 1 (65 - 1 = 64)
  int AZ = CHAR('Z') - A1; // кол-во букв в англ. алфавите (90 - 64 = 26)
  int t, m;
  AnsiString S; // чтоб экономить память IV=256 последний столбец
  // номер колонки
  t = div(ACol, AZ).quot; // целая часть
  m = div(ACol, AZ).rem; // остаток?
  if(m == 0) t--;
  if (t > 0) S = AnsiString(CHAR(A1 + t)); else S = "";
  if(m == 0) t = AZ; else t = m;
  S = S + Char(A1 + t);
  // весь адрес
  if(ColAbsolute) S = "$" + S;
  if(RowAbsolute) S = S + "$";
  S = S + IntToStr(ARow);
  return S;  */
}
public:		// User declarations
	__fastcall TFormExcelExport(TComponent* Owner, TIBDatabase * MainConn_local);
};
//---------------------------------------------------------------------------
extern PACKAGE TFormExcelExport *FormExcelExport;
//---------------------------------------------------------------------------
#endif
